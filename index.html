<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Inventario de Compras</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
body{font-family:"Segoe UI",sans-serif;margin:0;background:#fff8e1}
h2{margin:70px 10px 15px;font-size:1.6rem;background:#ff9800;color:#fff;border:2px solid #e65100;border-radius:8px;padding:10px}
.actions{position:fixed;top:0;left:0;right:0;z-index:10;background:#fff8e1;padding:8px;display:flex;gap:6px;flex-wrap:wrap;justify-content:center;box-shadow:0 2px 4px rgba(0,0,0,.1)}
button{flex:1;padding:12px;border:none;border-radius:8px;color:#fff;font-weight:600;font-size:1rem;cursor:pointer}
.btn-marcar{background:#4caf50}.btn-desmarcar{background:#f44336}.btn-share{background:#9c27b0}
#newItem{padding:10px;width:60%;max-width:220px;border:1px solid #ccc;border-radius:8px}
table{width:100%;border-collapse:collapse;margin-top:12px}
th,td{border:1px solid #ddd;padding:6px;vertical-align:middle;text-align:left}
th{background:#ffcc80}
.faltante{background:#ffefef}
td.unidad{text-align:center;font-weight:700;white-space:nowrap}
input[type=number]{width:80px;padding:6px;border-radius:6px;border:1px solid #ccc;text-align:center}
input[type=number]{-moz-appearance:textfield}input::-webkit-outer-spin-button,input::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}
@media(max-width:700px){
 table,thead,tbody,tr,th,td{display:block}
 thead{display:none}
 tr{background:#fff;margin:8px;border:1px solid #ddd;border-radius:8px;padding:8px}
 td{border:none;display:flex;justify-content:space-between;padding:6px}
 td:before{font-weight:600}
 td:nth-child(1):before{content:"Producto:"}
 td:nth-child(2):before{content:"Cantidad actual:"}
 td:nth-child(3):before{content:"Cantidad falta:"}
 td:nth-child(4):before{content:"Unidad:"}
 td:nth-child(5):before{content:"Falta?"}
}
</style>
</head>
<body>
<div class="actions">
 <button class="btn-marcar" onclick="cambiarTodos(1)">‚úî Marcar</button>
 <button class="btn-desmarcar" onclick="cambiarTodos(0)">‚úñ Desmarcar</button>
 <button class="btn-share" onclick="compartir()">üì≤ Compartir</button>
</div>
<h2><i class="fas fa-clipboard-list"></i> Inventario</h2>
<input id="newItem" placeholder="Nuevo producto...">
<button class="btn-marcar" onclick="agregarProducto()">Agregar</button>

<table><thead><tr><th>Producto</th><th>Cantidad actual</th><th>Cantidad falta</th><th>Unidad</th><th>Falta?</th></tr></thead>
<tbody id="lista"></tbody></table>

<script>
const lista=document.getElementById("lista"),LS="lista_compra";
const productos={
 "Aceite":"litros","Aguacate":"kg","Az√∫car":"kg","Carne":"kg","Cebolla":"kg","Huevos":"kg","Jam√≥n":"kg",
 "Leche":"litros","Lim√≥n":"kg","Pan":"piezas","Papa":"kg","Pollo":"kg","Queso":"piezas","Sal":"kg",
 "Aceite de oliva":"piezas","Agua simple para beber":"piezas","Agua simple para aguas de sabor":"piezas",
 "Alfalfa":"piezas","Bolsa de asa":"piezas","Bolsa de 15 x 25":"piezas","Bolsa de 30 x 40":"piezas",
 "Bolsa de papel":"piezas","Carlota de lim√≥n":"piezas","Flan":"piezas","Carnation":"piezas",
 "Chipotle":"kg","Desengrasante":"unidad","Enchilada":"kg","Fibra de metal":"unidad",
 "Gel antibacterial":"unidad","Jab√≥n para manos":"unidad","Guantes":"unidad","Jab√≥n para trastes":"unidad",
 "Pan molido":"kg","Papas a la francesa":"kg","Pata":"kg","Pelapapas":"unidad","Polvos":"kg","P√°palo":"piezas",
 "Quesillo":"kg","Salchicha":"kg","Servilletas":"piezas","Tapas de vaso de medio":"piezas",
 "Tapas de vaso de litro":"piezas","Trapos":"unidad","Vainilla":"piezas","Vasos de medio":"piezas",
 "Vaso de litro":"piezas"
};

function crearFila(n,cA=0,cF=0,f=false){
 const u=productos[n]||"piezas",tr=document.createElement("tr");
 tr.innerHTML=`<td>${n}</td>
 <td><input type="number" inputmode="decimal" value="${cA}" min="0" oninput="guardar()"></td>
 <td><input type="number" inputmode="decimal" value="${cF}" min="0" oninput="guardar()"></td>
 <td class="unidad">${u}</td>
 <td><input type="checkbox" ${f?"checked":""} onchange="toggle(this)"></td>`;
 if(f) tr.classList.add("faltante"); lista.appendChild(tr);
}
function guardar(){
 const d=[...lista.rows].map(r=>[r.cells[0].innerText,
  r.cells[1].querySelector("input").value,
  r.cells[2].querySelector("input").value,
  r.cells[4].querySelector("input").checked]);
 localStorage.setItem(LS,JSON.stringify(d));
}
function cargar(){
 (JSON.parse(localStorage.getItem(LS)||"[]")).forEach(([n,cA,cF,f])=>{
  const fila=[...lista.rows].find(fl=>fl.cells[0].innerText===n);
  if(fila){
    fila.cells[1].querySelector("input").value=cA;
    fila.cells[2].querySelector("input").value=cF;
    fila.cells[4].querySelector("input").checked=f;
    fila.classList.toggle("faltante",f);
  } else crearFila(n,cA,cF,f);
 });
}
function toggle(cb){cb.closest("tr").classList.toggle("faltante",cb.checked);guardar();}
function cambiarTodos(v){lista.querySelectorAll("input[type=checkbox]").forEach(c=>{c.checked=!!v;toggle(c)});}
function obtenerTodo(){return[...lista.rows].map(r=>`${r.cells[0].innerText} ‚Üí ${r.cells[1].querySelector("input").value} ${r.cells[3].innerText}`);}
function obtenerFaltantes(){return[...lista.rows].filter(r=>r.cells[4].querySelector("input").checked).map(r=>`${r.cells[0].innerText} ‚Üí ${r.cells[2].querySelector("input").value} ${r.cells[3].innerText}`);}
function compartir(){
 let m="üìã *Inventario Completo:*\n"+obtenerTodo().map(x=>"- "+x).join("\n"),
 f=obtenerFaltantes(); m+=f.length?"\n\nüõí *Faltantes:*\n"+f.map(x=>"- "+x).join("\n"):"\n\n‚úÖ No falta nada.";
 window.open("https://wa.me/?text="+encodeURIComponent(m),"_blank");
}
function agregarProducto(){
 const n=document.getElementById("newItem").value.trim();
 if(!n)return alert("Escribe un producto");
 if([...lista.rows].some(r=>r.cells[0].innerText.toLowerCase()==n.toLowerCase()))return alert("Ya existe");
 productos[n]=productos[n]||"piezas";crearFila(n,0,0,0);guardar();document.getElementById("newItem").value="";
}
Object.keys(productos).sort((a,b)=>a.localeCompare(b,"es")).forEach(p=>crearFila(p));
cargar();
</script>
</body>
</html>
